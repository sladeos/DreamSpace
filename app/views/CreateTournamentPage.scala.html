@(message: String)

<!DOCTYPE html>

<html>
    <head>
        @Templates.head()
        <script src="@routes.Assets.at("javascripts/jquery.bracket.min.js")" type="text/javascript"></script>
		<link rel="stylesheet"  href="@routes.Assets.at("stylesheets/jquery.bracket.min.css")">+
        @Templates.facebookHeadScript()
        
    </head>
    
    <body>

     <div data-role="page" data-theme="b" class="page">   
        @Templates.header()
        <div data-role="content" class = "content" >   
           
 
            <h1 align="center">Create your tournament</h1>
            You can change the name of the teams in your tournament by clicking the respective team label, you can also change the score by clicking the label after the team name. This updates the bracket.
   
   <div id='bracket'></div>
                <div id='bracketForm'>
                <form name="bracketGenerate" >
                Name of your tournament: <input type="text" name="fname" id="fname">
                Amount of players: 
        <select id="amount">
            <option value="4">4</option>
            <option value="8">8</option>
            <option value="16">16</option>
            <option value="32">32</option>
        </select> 
        
       
        <input type="button" value="Create" id="create">
            <p id="warning"></p>
        
    </form>
    
    </div>
   <script type="text/javascript">
    var tNameOkay = true;
        $(function() {
    	function errorInField(){
    	 $("#warning").css('color', 'red');
         $('#warning').prepend('<img id="redcross" src="@routes.Assets.at("images/redcross.png")" />')
         $('#redcross').width(40);
         $('#redcross').height(40);
         tNameOkay = false;
    }
    	
    	function fieldOkay(){
    	    $("#warning").css('color', 'green');
            $('#warning').prepend('<img id="greentick" src="@routes.Assets.at("images/greentick.png")" />')
            $('#greentick').width(40);
            $('#greentick').height(40);
            tNameOkay = true;
    		
    	}
    
    $('#fname').change(function() {
   	 if( $('#fname').val().length <4){
   		 $("#warning").html('Tournament Name is too short! Please enter a minimum of 4 characters');
   		errorInField()
            return;
   	 }else{
       $("#warning").html("Tournament Name is okay!");
	   fieldOkay()
	   
   }

    })
        })
    
    
    </script>
   
    <script>
$(function() {
    
    generateBracket($('#amount').val());
    
    var data;
    
    function saveFn(data) {
        
    }
    
    function generateBracket(playerAmount) {
    
    var teamData = {
    teams : [] 
    };
    
    playerAmount = playerAmount /2
    
    var j = 1;
    for (i = 0; i < playerAmount; i++) { 
    teamData.teams[i] = ["Team " + j, "Team " + ++j];
    j++;
    }
    
    var container = $('#bracket')
    container.bracket({
      init: teamData,
      save: saveFn
    })
    
    $('.tools').remove();
  
    data = container.bracket('data') ;
 
    }
    
    $("#amount").change(function() {
   
    var players = Number($('#amount').val());
    
    switch(players) {
    case 4:
    generateBracket(4);
        break;
    case 8:
    generateBracket(8);
        break;
    case 16:
    generateBracket(16);
        break;
    case 32:
    generateBracket(32);
        break;
    
    }
    
    
});


$("#create").click(function() {
    if(tNameOkay && $('#fname').val().length >4){
    var teams = data.teams
    var results = data.results

      $.ajax({
            url: "/savetournament",
            type: 'POST',
            contentType:'application/json',
            data: JSON.stringify({name :  $('#fname').val(), amount: $('#amount').val(), teams: teams, results: results }),
            dataType : 'html',
            success: function(){
                window.location.replace("/tournament");
            }
        });
    }else{
    	
    	 $("#warning").html("There are errors in your tournament! Fix them and try again.");
    	 $("#warning").css('color', 'red');
         $('#warning').prepend('<img id="redcross" src="@routes.Assets.at("images/redcross.png")" />')
         $('#redcross').width(40);
         $('#redcross').height(40);
    	
    }
        });

});
    </script>
        </div>
  
            @Templates.footer()
            @Templates.panelAndLogOut()
        </div>
    
    </body>
</html> 
